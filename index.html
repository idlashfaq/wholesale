<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wholesale Order</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f8f9fa;
        }
        .product img {
            width: 100%;
            height: 180px;
            object-fit: contain;
        }
        .product {
            transition: 0.3s ease;
        }
        .product:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

<div class="container py-4">
    <h1 class="text-center mb-4 text-success fw-bold">Wholesale Order</h1>

    <!-- Tabs -->
    <ul class="nav nav-tabs justify-content-center mb-3" id="productTabs">
        <li class="nav-item">
            <a class="nav-link active" href="#" data-tab="lays">Lays</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#" data-tab="pepsi">Pepsi</a>
        </li>
    </ul>

    <!-- Search -->
    <div class="row mb-3">
        <div class="col-md-6 mx-auto">
            <input type="text" id="search" class="form-control" placeholder="Search flavor...">
        </div>
    </div>

    <!-- Shop Name -->
    <div class="row mb-4">
        <div class="col-md-6 mx-auto">
            <label class="form-label fw-bold">Enter your shop name:</label>
            <input type="text" id="shopNameInput" class="form-control" placeholder="Type your shop name...">
        </div>
    </div>

    <!-- Lays Listing -->
    <div class="row g-4 tab-content" id="lays"></div>

    <!-- Pepsi Listing -->
    <div class="row g-4 tab-content" id="pepsi" style="display:none;">
        <div class="col-md-4">
            <div class="card product h-100 p-2 text-center" data-name="Pepsi Bottle 1.5L" data-price="1200" data-pieces="12">
                <img src="https://i.ibb.co/LPCL7p3/pepsi-1-5l.jpg" class="card-img-top" alt="Pepsi Bottle 1.5L">
                <div class="card-body">
                    <h5 class="card-title">Pepsi Bottle 1.5L</h5>
                    <p class="fw-bold">Box Price: PKR 1200</p>
                    <p>Price per Bottle: PKR <span class="piece-price"></span></p>
                    <input type="number" class="form-control quantity mb-3" value="1" min="1">
                    <a href="#" class="btn btn-success w-100" onclick="orderNow(this)">Order on WhatsApp</a>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card product h-100 p-2 text-center" data-name="Pepsi Can 250ml" data-price="900" data-pieces="24">
                <img src="https://i.ibb.co/VxHqK7m/pepsi-can.jpg" class="card-img-top" alt="Pepsi Can 250ml">
                <div class="card-body">
                    <h5 class="card-title">Pepsi Can 250ml</h5>
                    <p class="fw-bold">Box Price: PKR 900</p>
                    <p>Price per Can: PKR <span class="piece-price"></span></p>
                    <input type="number" class="form-control quantity mb-3" value="1" min="1">
                    <a href="#" class="btn btn-success w-100" onclick="orderNow(this)">Order on WhatsApp</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="orderConfirmModal" tabindex="-1" aria-labelledby="orderConfirmLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title" id="orderConfirmLabel">Confirm Your Order</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p id="orderSummary" class="mb-0"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" id="confirmOrderBtn">Confirm & Send</button>
        </div>
      </div>
    </div>
  </div>

<!-- Bootstrap 5 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    fetch('data/lays.json')
    .then(response => response.json())
    .then(data => {
        const laysContainer = document.getElementById('lays');
        laysContainer.innerHTML = '';

        data.forEach(product => {
            const perPiecePrice = (product.price / product.pieces).toFixed(2);

            const productHTML = `
                <div class="col-md-4">
                    <div class="card product h-100 p-2 text-center" 
                        data-name="${product.name}" 
                        data-price="${product.price}" 
                        data-pieces="${product.pieces}">
                        <img src="${product.image}" class="card-img-top" alt="${product.name}">
                        <div class="card-body">
                            <h5 class="card-title">${product.name}</h5>
                            <p class="fw-bold">Box Price: PKR ${product.price}</p>
                            <p>Wholesale Price per Pack: PKR <span class="piece-price">${perPiecePrice}</span></p>
                            <p>Retail Price per Pack: PKR <span class="retail-price">${product.retailPrice}</span></p>
                            <input type="number" class="form-control quantity mb-3" value="1" min="1">
                            <a href="#" class="btn btn-success w-100" onclick="orderNow(this)">Order on WhatsApp</a>
                        </div>
                    </div>
                </div>
            `;
            laysContainer.insertAdjacentHTML('beforeend', productHTML);
        });
    });

    let finalOrderURL = "";
    function orderNow(button) {
        let shopName = document.getElementById('shopNameInput').value.trim();
        if (!shopName) {
            alert("Please enter your shop name");
            return;
        }

        let product = button.closest('.product');
        let name = product.dataset.name;
        let pricePerBox = parseInt(product.dataset.price);
        let piecesInBox = parseInt(product.dataset.pieces);
        let qty = parseInt(product.querySelector('.quantity').value);
        let perPiecePrice = (pricePerBox / piecesInBox).toFixed(2);
        let totalPrice = pricePerBox * qty;

        let message = `*Shop Name: ${shopName}*\n\nOrder Details:\nProduct: ${name}\nBox Price: PKR ${pricePerBox}\nPieces in Box: ${piecesInBox}\nPrice per Piece: PKR ${perPiecePrice}\nTotal Boxes: ${qty}\nTotal Price: PKR ${totalPrice}`;
        finalOrderURL = `https://wa.me/+923024069411?text=${encodeURIComponent(message)}`;
        
        // Fill modal content
        document.getElementById("orderSummary").innerHTML = `
            <strong>Shop Name:</strong> ${shopName}<br>
            <strong>Product:</strong> ${name}<br>
            <strong>Box Price:</strong> PKR ${pricePerBox}<br>
            <strong>Pieces in Box:</strong> ${piecesInBox}<br>
            <strong>Price per Piece:</strong> PKR ${perPiecePrice}<br>
            <strong>Total Boxes:</strong> ${qty}<br>
            <strong>Total Price:</strong> PKR ${totalPrice}
        `;

        // Show modal
        new bootstrap.Modal(document.getElementById('orderConfirmModal')).show();
    }
    // Confirm button click
    document.getElementById("confirmOrderBtn").addEventListener("click", function() {
        window.open(finalOrderURL, '_blank');
        bootstrap.Modal.getInstance(document.getElementById('orderConfirmModal')).hide();
    });

    document.getElementById('search').addEventListener('keyup', function() {
        let searchValue = this.value.toLowerCase();
        document.querySelectorAll('.tab-content:not([style*="display: none"]) .product').forEach(function(product) {
            let name = product.dataset.name.toLowerCase();
            product.parentElement.style.display = name.includes(searchValue) ? '' : 'none';
        });
    });

    document.querySelectorAll('#productTabs .nav-link').forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            document.querySelectorAll('#productTabs .nav-link').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
            document.getElementById(tab.dataset.tab).style.display = 'flex';
        });
    });
</script>

</body>
</html>
